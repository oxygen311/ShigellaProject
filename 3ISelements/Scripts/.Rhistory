# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
nrow(filter(stats_for_pic, Pathovar == "ExPEC")
)
IS_numbers <- stats_for_pic
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("non-pathogenic\nE. coli", "Shigella spp.", "STEC", "ExPEC", "ETEC", "APEC", "EPEC", "AIEC", "EAEC", "EHEC", "EIEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
View(IS_numbers)
## uncomment for a plot with all pathovars
IS_numbers <- stats_for_pic %>%
filter(Pathovar != "pathogenic\nE. coli")
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("non-pathogenic\nE. coli", "Shigella spp.", "STEC", "ExPEC", "ETEC", "APEC", "EPEC", "AIEC", "EAEC", "EHEC", "EIEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
## uncomment for a plot with all pathovars
IS_numbers <- stats_for_pic %>%
filter(Pathovar != "pathogenic\nE. coli")
filter(!(Pathovar %in% c("pathogenic\nE. coli", "all E. coli"))
filter(!(Pathovar %in% c("pathogenic\nE. coli", "all E. coli"))
## uncomment for a plot with all pathovars
IS_numbers <- stats_for_pic %>%
filter(!(Pathovar %in% c("pathogenic\nE. coli", "all E. coli")))
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("non-pathogenic\nE. coli", "Shigella spp.", "STEC", "ExPEC", "ETEC", "APEC", "EPEC", "AIEC", "EAEC", "EHEC", "EIEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
stats = read.csv("/Users/zairaseferbekova/bac_lab/статистика/
stats = read.csv("/Users/zairaseferbekova/bac_lab/статистика/total_stats.csv", sep=",")
stats = read.csv("/Users/zairaseferbekova/bac_lab/статистика/total_stats.csv", sep=",")
nrow(filter(stats_for_pic, Pathovar == "ExPEC"))
setwd("/Users/zairaseferbekova/bac_lab/статистика")
stats = read.csv("/Users/zairaseferbekova/bac_lab/статистика/total_stats.csv", sep=",")
library(ggplot2)
library(reshape2)
library(ggpubr)
library(tidyverse)
shigella = stats %>%
filter(Info == "Shigellosis" & Type == "Chromosome")
all_ecoli = stats %>%
filter(Info != "Shigellosis" & Type == "Chromosome" & Organism != "Shigella sp. PAMC 28760")
expec = all_ecoli %>%
filter(Info == "ExPEC")
stec = all_ecoli %>%
filter(Info == "STEC")
non_path_ecoli = all_ecoli %>%
filter(Info == "")
path_ecoli = all_ecoli %>%
filter(Info %in% c("STEC", "ETEC", "ExPEC", "EAEC", "EPEC", "APEC", "AIEC", "EIEC", "EHEC"))
is1 <- data.frame(shigella$ISTransposaseCount.ISsaga.)
colnames(is1)[1] <- "ISnumber"
is1 = transform(is1, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is1 <- data.frame(is1$ISnumber[1])
is1$phylum <- "Shigella spp."
colnames(is1)[1] <- "ISnumber"
is2 <- data.frame(non_path_ecoli$ISTransposaseCount.ISsaga.)
colnames(is2)[1] <- "ISnumber"
is2 = transform(is2, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is2 <- data.frame(is2$ISnumber[1])
shigella = stats %>%
filter(Info == "Shigellosis" & Type == "Chromosome")
is1 <- data.frame(shigella$ISTransposaseCount.ISsaga.)
setwd("/Users/zairaseferbekova/bac_lab/статистика")
stats = read.csv("/Users/zairaseferbekova/bac_lab/статистика/total_stats.csv", sep=",")
View(stats)
shigella = stats %>%
filter(Info == "shigellosis" & Type == "Chromosome")
all_ecoli = stats %>%
filter(Info != "shigellosis" & Type == "Chromosome" & Organism != "Shigella sp. PAMC 28760")
expec = all_ecoli %>%
filter(Info == "ExPEC")
stec = all_ecoli %>%
filter(Info == "STEC")
non_path_ecoli = all_ecoli %>%
filter(Info == "")
path_ecoli = all_ecoli %>%
filter(Info %in% c("STEC", "ETEC", "ExPEC", "EAEC", "EPEC", "APEC", "AIEC", "EIEC", "EHEC"))
is1 <- data.frame(shigella$ISTransposaseCount.ISsaga.)
colnames(is1)[1] <- "ISnumber"
is1 = transform(is1, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is1 <- data.frame(is1$ISnumber[1])
is1$phylum <- "Shigella spp."
colnames(is1)[1] <- "ISnumber"
is2 <- data.frame(non_path_ecoli$ISTransposaseCount.ISsaga.)
colnames(is2)[1] <- "ISnumber"
is2 = transform(is2, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is2 <- data.frame(is2$ISnumber[1])
is2$phylum <- "non-pathogenic\nE. coli"
colnames(is2)[1] <- "ISnumber"
is3 <- data.frame(expec$ISTransposaseCount.ISsaga.)
colnames(is3)[1] <- "ISnumber"
is3 = transform(is3, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is3 <- data.frame(is3$ISnumber[1])
is3$phylum <- "ExPEC"
colnames(is3)[1] <- "ISnumber"
is4 <- data.frame(all_ecoli$ISTransposaseCount.ISsaga.)
colnames(is4)[1] <- "ISnumber"
is4 = transform(is4, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is4 <- data.frame(is4$ISnumber[1])
is4$phylum <- "all E. coli"
colnames(is4)[1] <- "ISnumber"
is5 <- data.frame(stec$ISTransposaseCount.ISsaga.)
colnames(is5)[1] <- "ISnumber"
is5 = transform(is5, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is5 <- data.frame(is5$ISnumber[1])
is5$phylum <- "STEC"
colnames(is5)[1] <- "ISnumber"
is6 <- data.frame(path_ecoli$ISTransposaseCount.ISsaga.)
colnames(is6)[1] <- "ISnumber"
is6 = transform(is6, ISnumber = colsplit(ISnumber, "\\/", names = c('1', '2')))
is6 <- data.frame(is6$ISnumber[1])
is6$phylum <- "pathogenic\nE. coli"
colnames(is6)[1] <- "ISnumber"
iss <- rbind(is2, is3, is5, is4)
iss$ISnumber <- as.numeric(iss$ISnumber)
my_comparisons <- list( c("STEC", "all E. coli"),
c("STEC", "non-pathogenic\nE. coli"),
c("all E. coli", "ExPEC"),
c("non-pathogenic\nE. coli", "ExPEC"),
c("STEC", "ExPEC"))
ggplot(data = iss, aes(x = phylum, y = ISnumber)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
ylim(0,1100) +
xlab("") +
stat_compare_means(comparisons = my_comparisons1, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
ylab("Number of IS elements") +
#labs(title = "Comparison of IS elements numbers") +
theme_classic()
ggplot(data = iss, aes(x = phylum, y = ISnumber)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
ylim(0,1100) +
xlab("") +
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
ylab("Number of IS elements") +
#labs(title = "Comparison of IS elements numbers") +
theme_classic()
ggplot(data = iss, aes(x = phylum, y = ISnumber)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
ylim(0,1100) +
xlab("") +
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "greater"), label = "p.signif",) +
ylab("Number of IS elements") +
#labs(title = "Comparison of IS elements numbers") +
theme_classic()
ggplot(data = iss, aes(x = phylum, y = ISnumber)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
#ylim(0,1100) +
xlab("") +
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "greater"), label = "p.signif",) +
ylab("Number of IS elements") +
#labs(title = "Comparison of IS elements numbers") +
theme_classic()
## Import total_stats.csv
stats = as.data.frame(read.csv("../Data/total_stats.csv", sep=",", stringsAsFactors = FALSE))
stats_for_pic <- stats %>%
ungroup() %>%
filter(Type == 'Chromosome') %>%
mutate(Pathovar = Info,
ISnumber = as.numeric(str_split(ISTransposaseCount.ISsaga., "/", simplify = T)[,1])) %>%
select(Organism, Pathovar, ISnumber)
stats_for_pic$Pathovar <- str_replace(stats_for_pic$Pathovar, "shigellosis", "Shigella spp.")
stats_for_pic$Pathovar <- stats_for_pic$Pathovar %>%
replace(stats_for_pic$Pathovar == "", "non-pathogenic\nE. coli")
path_ecoli <- stats_for_pic %>%
filter(Pathovar %in% c("EAEC","ExPEC","ETEC","STEC","EPEC","APEC","AIEC","EIEC","EHEC"))
path_ecoli$Pathovar <- "pathogenic\nE. coli"
all_ecoli <- stats_for_pic %>%
filter(Pathovar != "Shigella spp.")
all_ecoli$Pathovar <- "all E. coli"
stats_for_pic <- rbind(all_ecoli, path_ecoli, stats_for_pic)
my_comparisons <- list( c("all E. coli", "STEC"),
c("non-pathogenic\nE. coli", "STEC"),
c("all E. coli", "ExPEC"),
c("non-pathogenic\nE. coli", "ExPEC"),
c("ExPEC", "STEC"))
IS_numbers <- stats_for_pic %>%
filter(Pathovar %in% c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
my_comparisons <- list( c("all E. coli","STEC"),
c("STEC", "non-pathogenic\nE. coli"),
c("all E. coli", "ExPEC"),
c("non-pathogenic\nE. coli", "ExPEC"),
c("STEC", "ExPEC"))
ggplot(data = iss, aes(x = phylum, y = ISnumber)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
ylim(0,1100) +
xlab("") +
stat_compare_means(comparisons = my_comparisons1, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
ylab("Number of IS elements") +
#labs(title = "Comparison of IS elements numbers") +
theme_classic()
## uncomment for 'STEC, ExPEC vs others' plot
my_comparisons <- list( c("STEC", "all E. coli"),
c("non-pathogenic\nE. coli", "STEC"),
c("all E. coli", "ExPEC"),
c("non-pathogenic\nE. coli", "ExPEC"),
c("ExPEC", "STEC"))
IS_numbers <- stats_for_pic %>%
filter(Pathovar %in% c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "greater"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
## uncomment for 'STEC, ExPEC vs others' plot
my_comparisons <- list( c("all E. coli"),
c("non-pathogenic\nE. coli", "STEC"),
c("ExPEC", "all E. coli"),
c("ExPEC", "non-pathogenic\nE. coli"),
c("ExPEC", "STEC"))
IS_numbers <- stats_for_pic %>%
filter(Pathovar %in% c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
my_comparisons <- list( c("all E. coli","STEC"),
c("STEC", "non-pathogenic\nE. coli"),
c("all E. coli", "ExPEC"),
c("non-pathogenic\nE. coli", "ExPEC"),
c("STEC", "ExPEC"))
## uncomment for 'STEC, ExPEC vs others' plot
my_comparisons <- list( c("all E. coli", "STEC"),
c("non-pathogenic\nE. coli", "STEC"),
c("ExPEC", "all E. coli"),
c("ExPEC", "non-pathogenic\nE. coli"),
c("ExPEC", "STEC"))
IS_numbers <- stats_for_pic %>%
filter(Pathovar %in% c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
IS_numbers$Pathovar <- factor(IS_numbers$Pathovar, levels=c("all E. coli", "non-pathogenic\nE. coli", "STEC", "ExPEC"))
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylab("Number of IS elements")
ggsave("<Name>.png", device = "png", dpi = 720, width = 4, height = 3)
?wilcox.test()
x <- stats_for_pic["Pathovar" == ExPEC]$ISnumber
x <- stats_for_pic["Pathovar" == "ExPEC"]$ISnumber
View(stats_for_pic)
x <- stats_for_pic["Pathovar" == "ExPEC","ISnumber"]
x <- stats_for_pic[stats_for_pic$Pathovar == "ExPEC","ISnumber"]
y <- stats_for_pic[stats_for_pic$Pathovar == "a;; E. coli","ISnumber"]
wilcox.test(y, x, alternative = "less")
y <- stats_for_pic[stats_for_pic$Pathovar == "all E. coli","ISnumber"]
wilcox.test(y, x, alternative = "less")
wilcox.test(x, y, alternative = "less")
x
y
wilcox.test(x, y, alternative = "less", correct = T)
wilcox.test(x, y, alternative = "less", correct = T, exact = F)
wilcox.test(x, y, alternative = "less", correct = T, exact = T)
wilcox.test(x, y, alternative = "less", correct = F, exact = T)
ggsave("<Name>.png", device = "png", dpi = 720, width = 5, height = 4)
## Boxplot
ggplot(data = IS_numbers,
aes(x = Pathovar, y = ISnumber)) +
geom_boxplot(
# custom outliers
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
## comment if plotting all pathovars
stat_compare_means(comparisons = my_comparisons, method = "wilcox.test", method.args = list(alternative = "less"), label = "p.signif",) +
theme_classic() +
#theme(axis.text.x = element_text(angle = -15, hjust = 0.05)) +
xlab("") +
ylim(0, 510)+
ylab("Number of IS elements")
ggsave("<Name>.png", device = "png", dpi = 720, width = 4, height = 3)
## Import dependencies
library(tidyverse)
library(reshape2)
library(stringr)
library(ggpubr)
setwd('~/ShigellaProject/3ISelements/Scripts/')
f <- as.data.frame(read.csv("../Data/B1_IS_elements_selected.csv", stringsAsFactors = F))
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 3, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
View(labels)
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 4, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
View(labels)
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 5, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
View(labels)
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 6, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
colnames(f)[1] <- "strain"
f$strain <- labels[f$strain,]
f <- as.data.frame(read.csv("../Data/B1_IS_elements_selected.csv", stringsAsFactors = F))
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 6, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
colnames(f)[1] <- "strain"
f$strain <- labels[f$strain,]
View(f)
IS_families <- as.data.frame(read.csv("../Data/B1_IS_elements_selected.csv", stringsAsFactors = F))
labels <- as.data.frame(read.csv("../Results/Trees/labels.txt", skip = 6, sep = "\t", row.names = 1, header=F, colClasses = c("character")))
colnames(IS_families)[1] <- "strain"
IS_families$strain <- labels[IS_families$strain,]
View(IS_families)
melted_f <- melt(IS_families,id.vars = "strain")
View(melted_f)
melted_f$species <- melted_f$strain %>%
str_replace_all(c("Shigella"="S.", "Escherichia" = "E.")) %>%
word(1, 2, " ")
View(melted_f)
melted_f$value <- as.numeric(melted_f$value)
melted_f$variable <- factor(melted_f$variable, levels = c("IS1", "IS3", "IS4", "IS66", "IS21", "IS110", "IS91", "IS630"))
my_comparisons <- list( c("E. coli", "S. boydii"),
c("E. coli", "S. flexneri"),
c("E. coli", "S. sonnei") )
ggplot(melted_f, aes(x=species, y=value)) +
geom_boxplot(
outlier.colour="red",
outlier.fill="red",
outlier.size=2,
# custom boxes
color="blue",
fill="blue",
alpha=0.2,
) +
facet_wrap(~variable, scales = "free_y", ncol=4) +
xlab("") +
stat_compare_means(comparisons = my_comparisons, label = "p.signif", ) +
ylab("Number of IS elements") +
theme_linedraw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
#axis.text.x = element_text(angle = -15, hjust = 0.05),
text = element_text(size = 14))
